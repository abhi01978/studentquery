<!DOCTYPE html>
<html lang="en">
<head>
<!-- Basic Meta -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />

<!-- SEO Title -->
<title>EiWorldAi - AI Powered Learning, MCQs, Notes & Video Lectures</title>

<!-- Meta Description -->
<meta name="description" content="EiWorldAi is your personal AI-powered learning platform. Access MCQ practice, PDF notes, video lectures, previous year papers, and AI-powered doubt chat to boost your learning experience.">

<!-- Keywords -->
<meta name="keywords" content="EiWorldAi, AI study buddy, online learning, MCQ practice, PDF notes, video lectures, previous year papers, AI tutor, smart quiz, doubt chat, AI education, study app">

<!-- Open Graph / Social Media -->
<meta property="og:title" content="EiWorldAi - Your Personal AI Learning Companion" />
<meta property="og:description" content="Boost your learning with EiWorldAi: AI-powered MCQs, notes, video lectures, and doubt solving. Join EiWorldAi today!" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://studentquery.onrender.com/" />
<meta property="og:image" content="https://studentquery.onrender.com/og-image.png" />

<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="EiWorldAi - AI Powered Learning" />
<meta name="twitter:description" content="Access MCQs, notes, video lectures, and AI-powered doubt chat. Study smarter with EiWorldAi!" />
<meta name="twitter:image" content="https://studentquery.onrender.com/og-image.png" />
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet"/>
  <style>@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap'); body{font-family:'Inter',sans-serif;}</style>
</head>
<body class="bg-gray-50 min-h-screen">
  <div class="max-w-md mx-auto bg-white min-h-screen pb-20">
    <div class="bg-gradient-to-br from-blue-600 to-indigo-700 text-white p-6">
      <div class="flex items-center gap-4">
        <button onclick="history.back()" class="text-white"><i class="fas fa-arrow-left text-xl"></i></button>
        <h1 class="text-xl font-bold">Profile</h1>
      </div>
    </div>

  <div class="px-6 pt-8 text-center">

  <!-- Profile Image -->
  <div class="relative mx-auto w-32 h-32">
    <img id="uprofileImg"
         src="https://i.ibb.co/2y9g7Yt/user.png"
         class="w-28 h-28 rounded-full mx-auto border-4 border-white shadow-xl object-cover cursor-pointer"
         onclick="openImageModal(this.src)"
         onerror="this.src='https://i.ibb.co/2y9g7Yt/user.png'"/>
  </div>

  <h1 id="uname" class="text-2xl font-bold mt-4">Loading...</h1>
  <p id="udream" class="text-gray-600 italic mt-1"></p>

  <!-- Follower & Following -->
  <div class="flex justify-center gap-10 mt-6">
    <div onclick="openFollowingList('followers')">
      <div id="ufollowers" class="text-2xl font-bold cursor-pointer">0</div>
      <div class="text-xs text-gray-600">Followers</div>
    </div>
    <div onclick="openFollowingList('following')">
      <div id="ufollowing" class="text-2xl font-bold cursor-pointer">0</div>
      <div class="text-xs text-gray-600">Following</div>
    </div>
  </div>

  <button id="followBtn"
          class="mt-6 px-8 py-3 rounded-full font-bold text-white bg-blue-600 hover:bg-blue-700 shadow-lg">
    Follow
  </button>
</div>

<!-- User Info -->
<div class="px-6 mt-8 space-y-4">
  <div class="bg-gray-50 rounded-2xl p-5">
    <div class="flex items-center gap-4">
      <i class="fas fa-graduation-cap text-green-600"></i>
      <span id="ucourse">B.Tech â€¢ 5th Semester</span>
    </div>
  </div>

  <div class="bg-gray-50 rounded-2xl p-5">
    <div class="flex items-center gap-4">
      <i class="fas fa-university text-indigo-600"></i>
      <span id="ucollege">Not Set</span>
    </div>
  </div>
</div>



<!-- ðŸ”¥ IMAGE ZOOM MODAL -->
<div id="imgModal"
     class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center hidden z-[999]">

  <div class="relative">
    <!-- Close Button -->
    <span onclick="closeImageModal()"
          class="absolute -top-6 right-2 text-white text-4xl font-bold cursor-pointer">
      âœ–
    </span>

    <!-- Zoomed Image -->
    <img id="modalImg"
         class="max-w-[90vw] max-h-[80vh] rounded-xl shadow-2xl">
  </div>

</div>


<!-- ðŸ”¥ JS SCRIPT -->
<script>
function openImageModal(src) {
  document.getElementById("modalImg").src = src;
  document.getElementById("imgModal").classList.remove("hidden");
}

function closeImageModal() {
  document.getElementById("imgModal").classList.add("hidden");
}
</script>

  <script>
    const token = localStorage.getItem("token");
    const targetUserId = localStorage.getItem("viewUserId");

    async function loadUserProfile() {
      const res = await fetch("https://studentquery.onrender.com/api/users", { headers: { Authorization: `Bearer ${token}` }});
      const data = await res.json();
      const user = data.users.find(u => u._id === targetUserId);
      if (!user) return alert("User nahi mila");

      document.getElementById("uprofileImg").src = user.profileImg || "https://i.ibb.co/2y9g7Yt/user.png";
      document.getElementById("uname").textContent = user.name;
      document.getElementById("udream").textContent = user.dream ? `"${user.dream}"` : "Keep Growing â¤ï¸";
      document.getElementById("ucourse").textContent = user.course && user.semester ? `${user.course} â€¢ ${user.semester} Sem` : user.board || "Student";
      document.getElementById("ucollege").textContent = user.college || user.university || "Not Set";

      // Follow button logic
      const meRes = await fetch("https://studentquery.onrender.com/api/me", { headers: { Authorization: `Bearer ${token}` }});
      const meData = await meRes.json();
      const isFollowing = meData.user.following?.includes(user._id);

      const btn = document.getElementById("followBtn");
      if (isFollowing) {
        btn.textContent = "Following";
        btn.classList.replace("bg-blue-600", "bg-gray-300");
      }

      btn.onclick = () => toggleFollow(user._id, btn);
    }

    async function toggleFollow(id, btn) {
      await fetch(`https://studentquery.onrender.com/api/follow/${id}`, {
        method: "POST", headers: { Authorization: `Bearer ${token}` }
      });
      location.reload();
    }

    function openFollowingList(type) {
      localStorage.setItem("viewListType", type);
      localStorage.setItem("viewUserId", targetUserId);
      window.location.href = "following.html";
    }

    loadUserProfile();
  </script>
</body>
</html>
